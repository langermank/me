---
import Socials from './Socials.astro';
import { Image } from 'astro:assets';
import lightHeadshot from './images/headshot-light.jpg';
import darkHeadshot from './images/headshot-dark.jpg';


const isDiyDomain = Astro.site?.hostname?.includes('diy') || false;

// Dynamic URL configuration
const mainSiteUrl = import.meta.env.PROD ? 'https://katielangerman.com' : 'http://localhost:4321';

const workUrl = isDiyDomain ? mainSiteUrl : '/';

// Determine current page for aria-current
const isOnWorkSite = !isDiyDomain; // Main site is "work"

// More robust path matching for production
const currentPath = Astro.url.pathname.replace(/\/$/, '') || '/'; // Remove trailing slash, except for root
const isHomePage = currentPath === '/';
const isCvPage = currentPath === '/cv' || currentPath.endsWith('/cv');
---

<header>
  <div class="headshot">
    <Image
      src={lightHeadshot}
      alt="Katie Langerman"
      class="headshot-light"
    />
    <Image
      src={darkHeadshot}
      alt="Katie Langerman"
      class="headshot-dark"
    />
  </div>
  <h1 class="site-title">Katie Langerman</h1>
  <nav class="site-nav mobile">
    <ul>
      <li>
      <a href={workUrl} aria-current={isOnWorkSite && isHomePage ? 'page' : undefined}>
        Work
      </a>
    </li>
      {isOnWorkSite && (
        <li>
          <a href="/cv" aria-current={isCvPage ? 'page' : undefined}>CV</a>
        </li>
      )}

      <!-- <li>
        <a href={notWorkUrl} aria-current={isOnDiySite ? 'page' : undefined}>Not work</a>
      </li> -->
    </ul>
  </nav>
</header>

<nav class="site-nav desktop">
  <ul>
    <li>
      <a href={workUrl} aria-current={isOnWorkSite && isHomePage ? 'page' : undefined}>
        Work
      </a>
    </li>
    {isOnWorkSite && (
      <li>
        <a href="/cv" aria-current={isCvPage ? 'page' : undefined}>CV</a>
      </li>
    )}
    <!-- <li>
      <a href={notWorkUrl} aria-current={isOnDiySite ? 'page' : undefined}>Not work</a>
    </li> -->
  </ul>
  <Socials />
</nav>

<!-- <script>
  console.log('Header Debug Info:', {
    pathname: window.location.pathname,
    currentPath: window.location.pathname.replace(/\/$/, '') || '/',
    isCvPage: window.location.pathname.replace(/\/$/, '') === '/cv' || window.location.pathname.endsWith('/cv')
  });
</script> -->
